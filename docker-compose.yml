version: '2'

services:
  web:
    image: nginx
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    links:
      - app
    volumes_from:
      - app
    ports:
      - 8080:80
    networks:
        - external_network

  app:
    image: uracreative/identihub
    links:
      - db:mysql
    env_file: .env.docker
#    volumes:
#      - ./../storage/app:/var/www/app/storage:rw
#      - ./../storage/logo:/var/www/app/public/logo:rw
## only active for developing..
#      - .:/var/www/app:ro
#      - /var/www/app/vendor:rw
    restart: always
    networks:
        - external_network
        - internal_network
        
  db:
    image: mysql
    env_file: .env.docker
    restart: always
    volumes:
      - data-volume:/var/lib/mysql
    networks:
        - internal_network

networks:
    external_network:
    internal_network:
        internal: true

volumes:
  data-volume:
      
